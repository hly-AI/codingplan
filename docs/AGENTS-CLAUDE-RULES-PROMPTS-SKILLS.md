# AGENTS.md、CLAUDE.md、Rules、Prompts、Skills：区别、关系与协作

本文档说明 Cursor/CodingPlan 中五类配置的区别、关系及其在软件开发中的协作方式。

---

## 1. 区别概览

| 配置 | 本质 | 内容侧重 | 来源 | 加载时机 |
|------|------|----------|------|----------|
| **AGENTS.md** | 规则文件 | 「怎么做」：工作流、强制规则、输出约定 | 项目根目录 | Agent 启动时自动读取 |
| **CLAUDE.md** | 规则文件 | 「是什么」：项目背景、技术栈、架构 | 项目根目录 | Agent 启动时自动读取 |
| **Rules** | 规则文件 | 「怎么做」：细分规则（安全、API、UI 等） | .cursor/rules/*.mdc | 按 description/globs 条件加载 |
| **Prompts** | 任务指令 | 「当前做什么」：步骤任务、输入输出 | 由工具传入 | 每次调用 agent 时传入 |
| **Skills** | 能力扩展 | 「如何做得更好」：模板、结构、模式 | .cursor/skills/ 或 ~/.cursor/skills/ | Agent 按 description 按需选用 |

---

## 2. 各自职责

### AGENTS.md

- **定位**：工作流与流程规则
- **内容**：强制规则、输出目录、文档命名、多端提醒等
- **特点**：纯 Markdown，无元数据；通常常驻生效
- **适用**：CodingPlan 工作流、团队统一流程

### CLAUDE.md

- **定位**：项目上下文与背景
- **内容**：项目概述、技术栈、目录结构、编码规范、常用命令
- **特点**：由开发者填写，随项目演进
- **适用**：让 Agent 理解「这个项目是什么」

### Rules（.cursor/rules/*.mdc）

- **定位**：细分领域规则
- **内容**：安全、代码质量、API、UI、测试、数据库等
- **特点**：支持 globs、alwaysApply、description，可条件触发
- **适用**：按场景、按文件类型生效的规则

### Prompts

- **定位**：单次任务指令
- **内容**：当前步骤任务、输入文件、输出路径、约束
- **特点**：由 CodingPlan 等工具动态生成，每次调用不同
- **适用**：驱动「这一步具体做什么」

### Skills

- **定位**：专项能力与模板
- **内容**：文档结构、检查清单、实现模式、图表规范
- **特点**：Agent 根据 description 与上下文按需选用
- **适用**：提升某类任务的产出质量

---

## 3. 关系示意

```
                    ┌─────────────────────────────────────────┐
                    │          Cursor Agent 启动时加载          │
                    └─────────────────────────────────────────┘
                                         │
           ┌─────────────────────────────┼─────────────────────────────┐
           │                             │                             │
           ▼                             ▼                             ▼
    ┌──────────────┐             ┌──────────────┐             ┌──────────────┐
    │  AGENTS.md   │             │  CLAUDE.md   │             │    Rules     │
    │  （怎么做）   │             │  （是什么）   │             │  （细分规则）  │
    └──────────────┘             └──────────────┘             └──────────────┘
           │                             │                             │
           └─────────────────────────────┼─────────────────────────────┘
                                         │
                                         ▼
                    ┌─────────────────────────────────────────┐
                    │               Agent 上下文                │
                    │  （规则 + 项目背景，持久存在）              │
                    └─────────────────────────────────────────┘
                                         │
                                         │  每次调用时
                                         ▼
                    ┌─────────────────────────────────────────┐
                    │                 Prompts                  │
                    │  （当前步骤任务，由工具传入）               │
                    └─────────────────────────────────────────┘
                                         │
                                         │  按需选用
                                         ▼
                    ┌─────────────────────────────────────────┐
                    │                 Skills                   │
                    │  （模板、结构、模式，提升产出质量）          │
                    └─────────────────────────────────────────┘
```

---

## 4. 在软件开发中的协作

### 4.1 信息流向

```
CLAUDE.md     →  Agent 理解项目背景（技术栈、架构、规范）
AGENTS.md     →  Agent 遵守工作流与规则
Rules         →  Agent 遵守细分规则（安全、API、UI 等）
     │
     └──────────→ 共同构成「持久上下文」
                         │
Prompts       →  指定「当前步骤要做什么」（传入任务指令）
                         │
Skills        →  按需提供「如何做得更好」（模板、结构）
                         │
                         ▼
                    Agent 执行任务
```

### 4.2 以 CodingPlan 为例

| 阶段 | AGENTS.md | CLAUDE.md | Rules | Prompts | Skills |
|------|-----------|-----------|-------|---------|--------|
| Step 2 需求补全 | 流程规则 | 项目背景 | 多端等 | 需求补全任务 | codingplan-requirement |
| Step 3 概要设计 | 流程规则 | 技术栈 | - | 概要设计任务 | codingplan-outline, hld-mermaid |
| Step 4 详细设计 | 流程规则 | 架构 | API、DB | 详细设计任务 | codingplan-detail-design |
| Step 5 代码实现 | 流程规则 | 编码规范 | 安全、质量、UI | 实现任务 | codingplan-implement |
| Step 6 测试设计 | 流程规则 | 测试框架 | testing | 测试设计任务 | codingplan-test-design |
| Step 7 测试实现 | 流程规则 | - | testing | 测试实现任务 | codingplan-test-impl |

### 4.3 协作要点

1. **CLAUDE.md + Rules**：CLAUDE 描述项目，Rules 约束行为，二者互补。
2. **AGENTS.md + Prompts**：AGENTS 定流程，Prompts 定当前步骤，二者结合形成完整工作流。
3. **Prompts + Skills**：Prompts 指定任务，Skills 提供模板与模式，提升产出质量。
4. **Rules 与 Skills**：Rules 强调「必须遵守」，Skills 强调「如何更好」，侧重不同。

---

## 5. 总结

| 配置 | 一句话 |
|------|--------|
| **AGENTS.md** | 工作流与流程规则：「按什么流程做」 |
| **CLAUDE.md** | 项目背景：「项目是什么」 |
| **Rules** | 细分规则：「各类场景下要注意什么」 |
| **Prompts** | 任务指令：「当前这一步做什么」 |
| **Skills** | 能力扩展：「如何把这一步做得更好」 |

五者共同构成 Agent 的上下文与指令体系：**CLAUDE + AGENTS + Rules** 提供持久上下文，**Prompts** 提供当前任务，**Skills** 按需提供专业能力，一起支撑从需求到实现的自动化流程。
